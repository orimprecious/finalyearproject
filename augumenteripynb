{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyP/K33XzTV6ny21xRJyq93+"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"b6f7a0617b7b46538124491c04674ba3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_53b54973bc914e25b23e44b53be672fb","IPY_MODEL_6aeb36afad8942bfac8c60084c3f2f1d","IPY_MODEL_af46f52dffba41ad8937395500bb0963"],"layout":"IPY_MODEL_7c31b014bbfb4370aa0433d45147071f"}},"53b54973bc914e25b23e44b53be672fb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1e95db2d1877455c85fbcb43fb15d70a","placeholder":"​","style":"IPY_MODEL_bc2796e686474a759e0c7108d730d8f1","value":"100%"}},"6aeb36afad8942bfac8c60084c3f2f1d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8705e4fe7bd243a4b59f9d4e6188eea8","max":6240,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a9a122d189e04057bf791afa4c852fb7","value":6240}},"af46f52dffba41ad8937395500bb0963":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6b2f359660974b54987514a4e035078d","placeholder":"​","style":"IPY_MODEL_98e32cab791748d2b449e222008b374b","value":" 6240/6240 [3:13:42&lt;00:00,  2.16s/it]"}},"7c31b014bbfb4370aa0433d45147071f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e95db2d1877455c85fbcb43fb15d70a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bc2796e686474a759e0c7108d730d8f1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8705e4fe7bd243a4b59f9d4e6188eea8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a9a122d189e04057bf791afa4c852fb7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6b2f359660974b54987514a4e035078d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"98e32cab791748d2b449e222008b374b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"FqXSGxehl8L2"},"outputs":[],"source":["!pip install transformers\n","!pip install nlpaug\n","import inflect\n","p = inflect.engine()\n","from nltk.stem import PorterStemmer, WordNetLemmatizer\n","from nltk.tokenize import word_tokenize\n","from nltk.corpus import stopwords\n","from textblob import TextBlob\n","from wordcloud import WordCloud\n","import pandas as pd\n","import numpy as np\n","import re\n","import matplotlib.pyplot as plt\n","plt.style.use('fivethirtyeight')\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification\n","import torch\n","import requests\n","from bs4 import BeautifulSoup\n","import re\n","from google.colab import drive\n","drive.mount('/content/drive')\n","# READ THE CSV FILE\n","df = pd.read_csv(\"/content/drive/MyDrive/my_project_work/bert543remain2.csv\", index_col=0, lineterminator='\\n')\n","\n","df.shape\n","df.info()\n","df\n","df =df[df['text'].notnull()]\n","df.info()\n","import nlpaug.augmenter.word.context_word_embs as aug\n","augumenter = aug.ContextualWordEmbsAug(model_path='bert-base-uncased', action='insert')\n","sample_text = df['text'].iloc[100]\n","sample_text\n","augumented_sample_text = augumenter.augment(sample_text)\n","augumented_sample_text\n","df['sentiment'].value_counts()\n","from tqdm.auto import tqdm\n","from sklearn.utils import shuffle\n","def augmentMyData(df, augmenter, repetitions=1, samples=200):\n","    augmented_texts = []\n","    # select only the minority class samples\n","    spam_df = df[df['sentiment'] == 2].reset_index(drop=True) # removes unecessary index column\n","    for i in tqdm(np.random.randint(0, len(spam_df), samples)):\n","        # generating 'n_samples' augmented texts\n","        for _ in range(repetitions):\n","            augmented_text = augmenter.augment(spam_df['text'].iloc[i])\n","            augmented_texts.append(augmented_text)\n","    \n","    data = {\n","        'sentiment': 2,\n","        'text': augmented_texts\n","    }\n","    aug_df = pd.DataFrame(data)\n","    df = shuffle(df.append(aug_df).reset_index(drop=True))\n","    return df\n","aug_df = augmentMyData(df, augumenter, samples=6868)\n","aug_df\n","aug_df['sentiment'].value_counts()\n","aug_df.to_csv(\"/content/drive/MyDrive/my_project_work/bert5432finished.csv\")"]},{"cell_type":"code","source":["df=aug_df"],"metadata":{"id":"JLAF2hr-Hkpe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df"],"metadata":{"id":"C47gEn5THrK7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from tqdm.auto import tqdm\n","from sklearn.utils import shuffle\n","def augmentMyData1(df, augmenter, repetitions=1, samples=200):\n","    augmented_texts = []\n","    # select only the minority class samples\n","    spam_df = df[df['sentiment'] == 3].reset_index(drop=True) # removes unecessary index column\n","    for i in tqdm(np.random.randint(0, len(spam_df), samples)):\n","        # generating 'n_samples' augmented texts\n","        for _ in range(repetitions):\n","            augmented_text = augmenter.augment(spam_df['text'].iloc[i])\n","            augmented_texts.append(augmented_text)\n","    \n","    data = {\n","        'sentiment': 3,\n","        'text': augmented_texts\n","    }\n","    aug_df = pd.DataFrame(data)\n","    df = shuffle(df.append(aug_df).reset_index(drop=True))\n","    return df"],"metadata":{"id":"Jtq-tGjdHxce"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df2 = augmentMyData1(df, augumenter, samples=6240)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["b6f7a0617b7b46538124491c04674ba3","53b54973bc914e25b23e44b53be672fb","6aeb36afad8942bfac8c60084c3f2f1d","af46f52dffba41ad8937395500bb0963","7c31b014bbfb4370aa0433d45147071f","1e95db2d1877455c85fbcb43fb15d70a","bc2796e686474a759e0c7108d730d8f1","8705e4fe7bd243a4b59f9d4e6188eea8","a9a122d189e04057bf791afa4c852fb7","6b2f359660974b54987514a4e035078d","98e32cab791748d2b449e222008b374b"]},"id":"80L5X_THH4Rz","executionInfo":{"status":"ok","timestamp":1668220983827,"user_tz":-60,"elapsed":11622343,"user":{"displayName":"Da Great","userId":"03468156782177507885"}},"outputId":"c177f6cf-81bd-4e3b-c514-b7b743f876a6"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/6240 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b6f7a0617b7b46538124491c04674ba3"}},"metadata":{}}]},{"cell_type":"code","source":["df2['sentiment'].value_counts()"],"metadata":{"id":"HNoy5nu8xfSz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df2.to_csv(\"/content/drive/MyDrive/my_project_work/bert53remain42.csv\")"],"metadata":{"id":"uDOWUNWoxfS0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df2"],"metadata":{"id":"lx7Il9BsGtN-"},"execution_count":null,"outputs":[]}]}